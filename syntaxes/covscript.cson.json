{
	"version": "1.0.0",
	"name": "CovScript",
	"scopeName": "source.covscript",
	"fileTypes": [
		"csc",
		"csp"
	],
	"firstLineMatch": "^#!\\s*/.*(?:covscript|cs)\\b",
	"patterns": [
		{
			"captures": {
				"1": {
					"name": "keyword.control.class.covscript"
				},
				"2": {
					"name": "entity.name.type.class.covscript"
				},
				"4": {
					"name": "entity.other.inherited-class.covscript"
				}
			},
			"match": "(?x)\n^\\s*(class|struct)\\s+([A-Za-z_]\\w*)\\s+(extends\\s+(.*)\n)",
			"name": "meta.class.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "keyword.control.package.covscript"
				},
				"2": {
					"name": "entity.name.type.package.covscript"
				},
				"3": {
					"name": "entity.other.inherited-class.package.first.covscript"
				},
				"4": {
					"name": "punctuation.separator.inheritance.covscript"
				},
				"5": {
					"name": "entity.other.inherited-class.package.second.covscript"
				},
				"6": {
					"name": "punctuation.separator.inheritance.covscript"
				},
				"7": {
					"name": "entity.other.inherited-class.package.third.covscript"
				},
				"8": {
					"name": "punctuation.separator.inheritance.covscript"
				}
			},
			"match": "(?x)\n^\\s*(package)\\s+\n(\n  ([A-Z]\\w*(::))?\n  ([A-Z]\\w*(::))?\n  ([A-Z]\\w*(::))*\n  [A-Z]\\w*\n)",
			"name": "meta.package.covscript"
		},
		{
			"comment": "else if is a common mistake carried over from other languages. it works if you put in a second end, but itâ€™s never what you want.",
			"match": "(?<!\\.)\\belse(\\s)+if\\b",
			"name": "invalid.deprecated.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.constant.hashkey.covscript"
				}
			},
			"comment": "symbols as hash key (1.9 syntax)",
			"match": "(?>[a-zA-Z_]\\w*(?>[?!])?)(:)(?!:)",
			"name": "constant.language.symbol.hashkey.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.constant.covscript"
				}
			},
			"comment": "symbols as hash key (1.8 syntax)",
			"match": "(?<!:)(:)(?>[a-zA-Z_]\\w*(?>[?!])?)(?=\\s*=>)",
			"name": "constant.language.symbol.hashkey.covscript"
		},
		{
			"comment": "everything being a reserved word, not a value and needing a 'end' is a..",
			"match": "(?<!\\.)\\b(switch|struct|function|namespace|class|else|end|foreach|for|in|if|loop|until|while)\\b(?![?!])",
			"name": "keyword.control.covscript"
		},
		{
			"comment": "contextual smart pair support for block parameters",
			"match": "(?<!\\.)\\bdo\\b",
			"name": "keyword.control.start-block.covscript"
		},
		{
			"comment": "contextual smart pair support",
			"match": "(?<={)(\\s+)",
			"name": "meta.syntax.covscript.start-block"
		},
		{
			"match": "(?<!\\.)\\b(continue|break|return|this|var|link|constant)\\b(?![?!])|\\bdefined\\?|\\b(block_given|iterator)\\?",
			"name": "keyword.control.pseudo-method.covscript"
		},
		{
			"match": "\\bnull\\b(?![?!])",
			"name": "constant.language.nil.covscript"
		},
		{
			"match": "\\b(true|false)\\b(?![?!])",
			"name": "constant.language.boolean.covscript"
		},
		{
			"match": "\\b(__(FILE|LINE)__)\\b(?![?!])",
			"name": "variable.language.covscript"
		},
		{
			"match": "\\bself\\b(?![?!])",
			"name": "variable.language.self.covscript"
		},
		{
			"comment": " everything being a method but having a special function is a..",
			"match": "\\b(initialize|equal|duplicate|to_string|new|gcnew|loop|import|as|extends|catch|throw|using)\\b(?![?!])",
			"name": "keyword.other.special-method.covscript"
		},
		{
			"begin": "\\b(?<!\\.|::)(import)\\b(?![?!])",
			"captures": {
				"1": {
					"name": "keyword.other.special-method.covscript"
				}
			},
			"end": "$|(?=#|})",
			"name": "meta.require.covscript",
			"patterns": [
				{
					"include": "$self"
				}
			]
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.variable.covscript"
				}
			},
			"match": "(@)[a-zA-Z_]\\w*",
			"name": "variable.other.readwrite.instance.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.variable.covscript"
				}
			},
			"match": "(@@)[a-zA-Z_]\\w*",
			"name": "variable.other.readwrite.class.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.variable.covscript"
				}
			},
			"match": "(\\$)[a-zA-Z_]\\w*",
			"name": "variable.other.readwrite.global.covscript"
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.variable.covscript"
				}
			},
			"match": "(\\$)(!|@|&|`|'|\\+|\\d+|~|=|/|\\\\|,|;|\\.|<|>|_|\\*|\\$|\\?|:|\"|-[0adFiIlpv])",
			"name": "variable.other.readwrite.global.pre-defined.covscript"
		},
		{
			"begin": "\\b(ENV)\\[",
			"beginCaptures": {
				"1": {
					"name": "variable.other.constant.covscript"
				}
			},
			"end": "]",
			"name": "meta.environment-variable.covscript",
			"patterns": [
				{
					"include": "$self"
				}
			]
		},
		{
			"match": "\\b[A-Z]\\w*(?=((\\.|::)[A-Za-z]|\\[))",
			"name": "support.class.covscript"
		},
		{
			"match": "\\b[_A-Z]\\w*\\b",
			"name": "variable.other.constant.covscript"
		},
		{
			"begin": "(?x)\n(?=function\\b)                          # optimization to help Oniguruma fail fast\n(?<=^|\\s)(function)\\s+\n(\n  (?>[a-zA-Z_]\\w*(?>\\.|::))?      # method prefix\n  (?>                               # method name\n    [a-zA-Z_]\\w*(?>[?!]|=(?!>))?\n    |\n    ===?|!=|>[>=]?|<=>|<[<=]?|[%&`/\\|]|\\*\\*?|=?~|[-+]@?|\\[]=?\n  )\n)\n\\s*(\\()",
			"beginCaptures": {
				"1": {
					"name": "keyword.control.function.covscript"
				},
				"2": {
					"name": "entity.name.function.covscript"
				},
				"3": {
					"name": "punctuation.definition.parameters.covscript"
				}
			},
			"comment": "The method pattern comes from the symbol pattern. See there for an explanation.",
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.parameters.covscript"
				}
			},
			"name": "meta.function.method.with-arguments.covscript",
			"patterns": [
				{
					"begin": "(?![\\s,)])",
					"end": "(?=,|\\)\\s*$)",
					"patterns": [
						{
							"captures": {
								"1": {
									"name": "storage.type.variable.covscript"
								},
								"2": {
									"name": "constant.language.symbol.hashkey.parameter.function.covscript"
								},
								"3": {
									"name": "punctuation.definition.constant.hashkey.covscript"
								},
								"4": {
									"name": "variable.parameter.function.covscript"
								}
							},
							"match": "\\G([&*]?)(?:([_a-zA-Z]\\w*(:))|([_a-zA-Z]\\w*))"
						},
						{
							"include": "$self"
						}
					]
				}
			]
		},
		{
			"begin": "(?x)\n(?=function\\b)                          # optimization to help Oniguruma fail fast\n(?<=^|\\s)(function)\\s+\n(\n  (?>[a-zA-Z_]\\w*(?>\\.|::))?      # method prefix\n  (?>                               # method name\n    [a-zA-Z_]\\w*(?>[?!]|=(?!>))?\n    |\n    ===?|!=|>[>=]?|<=>|<[<=]?|[%&`/\\|]|\\*\\*?|=?~|[-+]@?|\\[]=?\n  )\n)\n[ \\t]\n(?=[ \\t]*[^\\s#;])                 # make sure the following is not comment",
			"beginCaptures": {
				"1": {
					"name": "keyword.control.function.covscript"
				},
				"2": {
					"name": "entity.name.function.covscript"
				}
			},
			"comment": "same as the previous rule, but without parentheses around the arguments",
			"end": "$",
			"name": "meta.function.method.with-arguments.covscript",
			"patterns": [
				{
					"begin": "(?![\\s,])",
					"end": "(?=,|$)",
					"patterns": [
						{
							"captures": {
								"1": {
									"name": "storage.type.variable.covscript"
								},
								"2": {
									"name": "constant.language.symbol.hashkey.parameter.function.covscript"
								},
								"3": {
									"name": "punctuation.definition.constant.hashkey.covscript"
								},
								"4": {
									"name": "variable.parameter.function.covscript"
								}
							},
							"match": "\\G([&*]?)(?:([_a-zA-Z]\\w*(:))|([_a-zA-Z]\\w*))"
						},
						{
							"include": "$self"
						}
					]
				}
			]
		},
		{
			"captures": {
				"1": {
					"name": "keyword.control.function.covscript"
				},
				"3": {
					"name": "entity.name.function.covscript"
				}
			},
			"comment": " the optional name is just to catch the function also without a method-name",
			"match": "(?x)\n(?=function\\b)                            # optimization to help Oniguruma fail fast\n(?<=^|\\s)(function)\\b\n(\n  \\s+\n  (\n    (?>[a-zA-Z_]\\w*(?>\\.|::))?      # method prefix\n    (?>                               # method name\n      [a-zA-Z_]\\w*(?>[?!]|=(?!>))?\n      |\n      ===?|!=|>[>=]?|<=>|<[<=]?|[%&`/\\|]|\\*\\*?|=?~|[-+]@?|\\[]=?\n    )\n  )\n)?",
			"name": "meta.function.method.without-arguments.covscript"
		},
		{
			"match": "(?x)\n\\b\n(\n  [\\d](?>_?\\d)*                             # 100_000\n  (\\.(?![^[:space:][:digit:]])(?>_?\\d)*)?   # fractional part\n  ([eE][-+]?\\d(?>_?\\d)*)?                   # 1.23e-4\n  |\n  0\n  (?:\n    [xX]\\h(?>_?\\h)*|\n    [oO]?[0-7](?>_?[0-7])*|\n    [bB][01](?>_?[01])*|\n    [dD]\\d(?>_?\\d)*\n  )                                           # A base indicator can only be used with an integer\n)\\b",
			"name": "constant.numeric.covscript"
		},
		{
			"begin": ":'",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"comment": "symbol literal with '' delimitor",
			"end": "'",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\['\\\\]",
					"name": "constant.character.escape.covscript"
				}
			]
		},
		{
			"begin": ":\"",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.symbol.begin.covscript"
				}
			},
			"comment": "symbol literal with \"\" delimitor",
			"end": "\"",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"comment": "Needs higher precidence than regular expressions.",
			"match": "(?<!\\()/=",
			"name": "keyword.operator.assignment.augmented.covscript"
		},
		{
			"begin": "'",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"comment": "string literal with '' delimitor",
			"end": "'",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.single.covscript",
			"patterns": [
				{
					"match": "\\\\'|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				}
			]
		},
		{
			"begin": "\"",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"comment": "string literal with interpolation and \"\" delimitor",
			"end": "\"",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.double.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "`",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"comment": "execute string (allows for interpolation)",
			"end": "`",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "(?x)\n(?<![\\w)])((/))(?![?*+])\n(?=\n  (?:\\\\/|[^/])*+          # Do NOT change the order\n  /[eimnosux]*\\s*\n  (?:\n    [)\\]}#.,?:]|\\|\\||&&|<=>|=>|==|=~|!~|!=|;|$|\n    if|else|elsif|then|do|end|unless|while|until|or|and\n  )\n  |\n  $\n)",
			"captures": {
				"1": {
					"name": "string.regexp.interpolated.covscript"
				},
				"2": {
					"name": "punctuation.section.regexp.covscript"
				}
			},
			"comment": "regular expression literal with interpolation",
			"contentName": "string.regexp.interpolated.covscript",
			"end": "((/[eimnosux]*))",
			"patterns": [
				{
					"include": "#regex_sub"
				}
			]
		},
		{
			"begin": "%r{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.regexp.begin.covscript"
				}
			},
			"end": "}[eimnosux]*",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.regexp.end.covscript"
				}
			},
			"name": "string.regexp.interpolated.covscript",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_curly_r"
				}
			]
		},
		{
			"begin": "%r\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.regexp.begin.covscript"
				}
			},
			"end": "][eimnosux]*",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.regexp.end.covscript"
				}
			},
			"name": "string.regexp.interpolated.covscript",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_brackets_r"
				}
			]
		},
		{
			"begin": "%r\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.regexp.begin.covscript"
				}
			},
			"end": "\\)[eimnosux]*",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.regexp.end.covscript"
				}
			},
			"name": "string.regexp.interpolated.covscript",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_parens_r"
				}
			]
		},
		{
			"begin": "%r<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.regexp.begin.covscript"
				}
			},
			"end": ">[eimnosux]*",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.regexp.end.covscript"
				}
			},
			"name": "string.regexp.interpolated.covscript",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_ltgt_r"
				}
			]
		},
		{
			"begin": "%r([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.regexp.begin.covscript"
				}
			},
			"end": "\\1[eimnosux]*",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.regexp.end.covscript"
				}
			},
			"name": "string.regexp.interpolated.covscript",
			"patterns": [
				{
					"include": "#regex_sub"
				}
			]
		},
		{
			"begin": "%I\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_brackets_i"
				}
			]
		},
		{
			"begin": "%I\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_parens_i"
				}
			]
		},
		{
			"begin": "%I<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_ltgt_i"
				}
			]
		},
		{
			"begin": "%I{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_curly_i"
				}
			]
		},
		{
			"begin": "%I([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "%i\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\]|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_brackets"
				}
			]
		},
		{
			"begin": "%i\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\\\)|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_parens"
				}
			]
		},
		{
			"begin": "%i<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\>|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_ltgt"
				}
			]
		},
		{
			"begin": "%i{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\}|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_curly"
				}
			]
		},
		{
			"begin": "%i([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"comment": "Cant be named because its not neccesarily an escape.",
					"match": "\\\\."
				}
			]
		},
		{
			"begin": "%W\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_brackets_i"
				}
			]
		},
		{
			"begin": "%W\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_parens_i"
				}
			]
		},
		{
			"begin": "%W<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_ltgt_i"
				}
			]
		},
		{
			"begin": "%W{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_curly_i"
				}
			]
		},
		{
			"begin": "%W([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "%w\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\]|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_brackets"
				}
			]
		},
		{
			"begin": "%w\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\\\)|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_parens"
				}
			]
		},
		{
			"begin": "%w<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\>|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_ltgt"
				}
			]
		},
		{
			"begin": "%w{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\}|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_curly"
				}
			]
		},
		{
			"begin": "%w([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.section.array.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.section.array.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"comment": "Cant be named because its not neccesarily an escape.",
					"match": "\\\\."
				}
			]
		},
		{
			"begin": "%[Qx]?\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_parens_i"
				}
			]
		},
		{
			"begin": "%[Qx]?\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_brackets_i"
				}
			]
		},
		{
			"begin": "%[Qx]?{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_curly_i"
				}
			]
		},
		{
			"begin": "%[Qx]?<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_ltgt_i"
				}
			]
		},
		{
			"begin": "%[Qx]([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "%([^\\w\\s=])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.interpolated.covscript",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "%q\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\\\)|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_parens"
				}
			]
		},
		{
			"begin": "%q<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\>|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_ltgt"
				}
			]
		},
		{
			"begin": "%q\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\]|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_brackets"
				}
			]
		},
		{
			"begin": "%q{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"match": "\\\\}|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_curly"
				}
			]
		},
		{
			"begin": "%q([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.quoted.other.covscript",
			"patterns": [
				{
					"comment": "Cant be named because its not neccesarily an escape.",
					"match": "\\\\."
				}
			]
		},
		{
			"begin": "%s\\(",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"end": "\\)",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\\\)|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_parens"
				}
			]
		},
		{
			"begin": "%s<",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"end": ">",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\>|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_ltgt"
				}
			]
		},
		{
			"begin": "%s\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"end": "]",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\]|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_brackets"
				}
			]
		},
		{
			"begin": "%s{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"end": "}",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"match": "\\\\}|\\\\\\\\",
					"name": "constant.character.escape.covscript"
				},
				{
					"include": "#nest_curly"
				}
			]
		},
		{
			"begin": "%s([^\\w])",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.begin.covscript"
				}
			},
			"end": "\\1",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.symbol.end.covscript"
				}
			},
			"name": "constant.language.symbol.covscript",
			"patterns": [
				{
					"comment": "Cant be named because its not neccesarily an escape.",
					"match": "\\\\."
				}
			]
		},
		{
			"captures": {
				"1": {
					"name": "punctuation.definition.constant.covscript"
				}
			},
			"comment": "symbols",
			"match": "(?x)\n(?<!:)(:)\n(?>\n  [$a-zA-Z_]\\w*(?>[?!]|=(?![>=]))?\n  |\n  ===?|<=>|>[>=]?|<[<=]?|[%&`/\\|]|\\*\\*?|=?~|[-+]@?|\\[]=?\n  |\n  @@?[a-zA-Z_]\\w*\n)",
			"name": "constant.language.symbol.covscript"
		},
		{
			"begin": "^=begin",
			"captures": {
				"0": {
					"name": "punctuation.definition.comment.covscript"
				}
			},
			"comment": "multiline comments",
			"end": "^=end",
			"name": "comment.block.documentation.covscript"
		},
		{
			"include": "#yard"
		},
		{
			"begin": "(^[ \\t]+)?(?=#)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.whitespace.comment.leading.covscript"
				}
			},
			"end": "(?!\\G)",
			"patterns": [
				{
					"begin": "#",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.comment.covscript"
						}
					},
					"end": "\\n",
					"name": "comment.line.number-sign.covscript"
				}
			]
		},
		{
			"comment": "\n\t\t\tmatches questionmark-letters.\n\n\t\t\texamples (1st alternation = hex):\n\t\t\t?\\x1     ?\\x61\n\n\t\t\texamples (2nd alternation = octal):\n\t\t\t?\\0      ?\\07     ?\\017\n\n\t\t\texamples (3rd alternation = escaped):\n\t\t\t?\\n      ?\\b\n\n\t\t\texamples (4th alternation = meta-ctrl):\n\t\t\t?\\C-a    ?\\M-a    ?\\C-\\M-\\C-\\M-a\n\n\t\t\texamples (4th alternation = normal):\n\t\t\t?a       ?A       ?0 \n\t\t\t?*       ?\"       ?( \n\t\t\t?.       ?#\n\t\t\t\n\t\t\t\n\t\t\tthe negative lookbehind prevents against matching\n\t\t\tp(42.tainted?)\n\t\t\t",
			"match": "(?<!\\w)\\?(\\\\(x\\h{1,2}(?!\\h)\\b|0[0-7]{0,2}(?![0-7])\\b|[^x0MC])|(\\\\[MC]-)+\\w|[^\\s\\\\])",
			"name": "constant.numeric.covscript"
		},
		{
			"begin": "^__END__\\n",
			"captures": {
				"0": {
					"name": "string.unquoted.program-block.covscript"
				}
			},
			"comment": "__END__ marker",
			"contentName": "text.plain",
			"end": "(?=not)impossible",
			"patterns": [
				{
					"begin": "(?=<?xml|<(?i:html\\b)|!DOCTYPE (?i:html\\b))",
					"end": "(?=not)impossible",
					"name": "text.html.embedded.covscript",
					"patterns": [
						{
							"include": "text.html.basic"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)HTML)\\b\\1))",
			"comment": "Heredoc with embedded html",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.html",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)HTML)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "text.html",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "text.html.basic"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)XML)\\b\\1))",
			"comment": "Heredoc with embedded xml",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.xml",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)XML)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "text.xml",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "text.xml"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)SQL)\\b\\1))",
			"comment": "Heredoc with embedded sql",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.sql",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)SQL)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.sql",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.sql"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)GRAPHQL)\\b\\1))",
			"comment": "Heredoc with embedded GraphQL",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.graphql",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)GRAPHQL)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.graphql",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.graphql"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)CSS)\\b\\1))",
			"comment": "Heredoc with embedded css",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.css",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)CSS)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.css",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.css"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)CPP)\\b\\1))",
			"comment": "Heredoc with embedded c++",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.cpp",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)CPP)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.cpp",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.cpp"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)C)\\b\\1))",
			"comment": "Heredoc with embedded c",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.c",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)C)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.c",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.c"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)(?:JS|JAVASCRIPT))\\b\\1))",
			"comment": "Heredoc with embedded javascript",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.js",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)(?:JS|JAVASCRIPT))\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.js",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.js"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)JQUERY)\\b\\1))",
			"comment": "Heredoc with embedded jQuery javascript",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.js.jquery",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)JQUERY)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.js.jquery",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.js.jquery"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)(?:SH|SHELL))\\b\\1))",
			"comment": "Heredoc with embedded shell",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.shell",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)(?:SH|SHELL))\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.shell",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.shell"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)LUA)\\b\\1))",
			"comment": "Heredoc with embedded lua",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.lua",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)LUA)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.lua",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.lua"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)covscript)\\b\\1))",
			"comment": "Heredoc with embedded covscript",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.covscript",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)covscript)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "source.covscript",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "source.covscript"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?=(?><<[-~]([\"'`]?)((?:[_\\w]+_|)SLIM)\\b\\1))",
			"comment": "Heredoc with embedded slim",
			"end": "(?!\\G)",
			"name": "meta.embedded.block.slim",
			"patterns": [
				{
					"begin": "(?><<[-~]([\"'`]?)((?:[_\\w]+_|)SLIM)\\b\\1)",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.string.begin.covscript"
						}
					},
					"contentName": "text.slim",
					"end": "^\\s*\\2$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.string.end.covscript"
						}
					},
					"name": "string.unquoted.heredoc.covscript",
					"patterns": [
						{
							"include": "#heredoc"
						},
						{
							"include": "#interpolated_ruby"
						},
						{
							"include": "text.slim"
						},
						{
							"include": "#escaped_char"
						}
					]
				}
			]
		},
		{
			"begin": "(?>=\\s*<<([\"'`]?)(\\w+)\\1)",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.covscript"
				}
			},
			"end": "^\\2$",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.unquoted.heredoc.covscript",
			"patterns": [
				{
					"include": "#heredoc"
				},
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "(?>((<<[-~]([\"'`]?)(\\w+)\\3,\\s?)*<<[-~]([\"'`]?)(\\w+)\\5))(.*)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.definition.string.begin.covscript"
				},
				"7": {
					"patterns": [
						{
							"include": "source.covscript"
						}
					]
				}
			},
			"comment": "heredoc with multiple inputs and indented terminator",
			"end": "^\\s*\\6$",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.covscript"
				}
			},
			"name": "string.unquoted.heredoc.covscript",
			"patterns": [
				{
					"include": "#heredoc"
				},
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				}
			]
		},
		{
			"begin": "(?<={|{\\s|[^A-Za-z0-9_]do|^do|[^A-Za-z0-9_]do\\s|^do\\s)(\\|)",
			"name": "meta.block.parameters.covscript",
			"captures": {
				"1": {
					"name": "punctuation.separator.variable.covscript"
				}
			},
			"end": "(?<!\\|)(\\|)(?!\\|)",
			"patterns": [
				{
					"begin": "(?![\\s,|(])",
					"end": "(?=,|\\|\\s*)",
					"patterns": [
						{
							"match": "\\G([&*]?)([a-zA-Z][\\w_]*)|(_[\\w_]*)",
							"captures": {
								"1": {
									"name": "storage.type.variable.covscript"
								},
								"2": {
									"name": "variable.other.block.covscript"
								},
								"3": {
									"name": "variable.other.block.unused.covscript variable.other.constant.covscript"
								}
							}
						}
					]
				},
				{
					"match": ",",
					"name": "punctuation.separator.variable.covscript"
				}
			]
		},
		{
			"match": "=>",
			"name": "punctuation.separator.key-value"
		},
		{
			"match": "->",
			"name": "support.function.kernel.covscript"
		},
		{
			"match": "<<=|%=|&{1,2}=|\\*=|\\*\\*=|\\+=|-=|\\^=|\\|{1,2}=|<<",
			"name": "keyword.operator.assignment.augmented.covscript"
		},
		{
			"match": "<=>|<(?!<|=)|>(?!<|=|>)|<=|>=|===|==|=~|!=|!~|(?<=[ \\t])\\?",
			"name": "keyword.operator.comparison.covscript"
		},
		{
			"match": "(?<!\\.)\\b(and|not|or)\\b(?![?!])",
			"name": "keyword.operator.logical.covscript"
		},
		{
			"match": "(?<=^|[ \\t])!|&&|\\|\\||\\^",
			"name": "keyword.operator.logical.covscript"
		},
		{
			"comment": "Safe navigation operator",
			"match": "(&\\.)\\s*(?![A-Z])",
			"captures": {
				"1": {
					"name": "keyword.operator.logical.covscript"
				}
			}
		},
		{
			"match": "(%|&|\\*\\*|\\*|\\+|-|/)",
			"name": "keyword.operator.arithmetic.covscript"
		},
		{
			"match": "=",
			"name": "keyword.operator.assignment.covscript"
		},
		{
			"match": "\\||~|>>",
			"name": "keyword.operator.other.covscript"
		},
		{
			"match": ";",
			"name": "punctuation.separator.statement.covscript"
		},
		{
			"match": ",",
			"name": "punctuation.separator.object.covscript"
		},
		{
			"comment": "Mark as namespace separator if double colons followed by capital letter",
			"match": "(::)\\s*(?=[A-Z])",
			"captures": {
				"1": {
					"name": "punctuation.separator.namespace.covscript"
				}
			}
		},
		{
			"comment": "Mark as method separator if double colons not followed by capital letter",
			"match": "(\\.|::)\\s*(?![A-Z])",
			"captures": {
				"1": {
					"name": "punctuation.separator.method.covscript"
				}
			}
		},
		{
			"comment": "Must come after method and constant separators to prefer double colons",
			"match": ":",
			"name": "punctuation.separator.other.covscript"
		},
		{
			"match": "{",
			"name": "punctuation.section.scope.begin.covscript"
		},
		{
			"match": "}",
			"name": "punctuation.section.scope.end.covscript"
		},
		{
			"match": "\\[",
			"name": "punctuation.section.array.begin.covscript"
		},
		{
			"match": "]",
			"name": "punctuation.section.array.end.covscript"
		},
		{
			"match": "\\(|\\)",
			"name": "punctuation.section.function.covscript"
		},
		{
			"begin": "(?=[a-zA-Z0-9_!?]+\\()",
			"end": "(?<=\\))",
			"name": "meta.function-call.covscript",
			"patterns": [
				{
					"include": "#nest_function_parens"
				},
				{
					"include": "#known_function_names"
				},
				{
					"match": "([a-zA-Z0-9_!?]+)((?=\\()|([!?]))",
					"name": "entity.name.function.covscript"
				},
				{
					"include": "$self"
				}
			]
		},
		{
			"comment": "This is kindof experimental. There really is no way to perfectly match all regular variables, but you can pretty well assume that any normal word in certain curcumstances that haven't already been scoped as something else are probably variables, and the advantages beat the potential errors",
			"match": "((?<=\\W)\\b|^)\\w+\\b(?=\\s*([\\]\\)\\}\\=\\+\\-\\*\\/\\^\\$\\,\\.\\&]|<\\s|<<[\\s|\\.]))",
			"name": "variable.other.covscript"
		}
	],
	"repository": {
		"escaped_char": {
			"match": "\\\\(?:[0-7]{1,3}|x[\\da-fA-F]{1,2}|.)",
			"name": "constant.character.escape.covscript"
		},
		"heredoc": {
			"begin": "^<<[-~]?\\w+",
			"end": "$",
			"patterns": [
				{
					"include": "$self"
				}
			]
		},
		"interpolated_ruby": {
			"patterns": [
				{
					"begin": "#{",
					"beginCaptures": {
						"0": {
							"name": "punctuation.section.embedded.begin.covscript"
						}
					},
					"contentName": "source.covscript",
					"end": "}",
					"endCaptures": {
						"0": {
							"name": "punctuation.section.embedded.end.covscript"
						}
					},
					"name": "meta.embedded.line.covscript",
					"patterns": [
						{
							"include": "#nest_curly_and_self"
						},
						{
							"include": "$self"
						}
					]
				},
				{
					"captures": {
						"1": {
							"name": "punctuation.definition.variable.covscript"
						}
					},
					"match": "(#@)[a-zA-Z_]\\w*",
					"name": "variable.other.readwrite.instance.covscript"
				},
				{
					"captures": {
						"1": {
							"name": "punctuation.definition.variable.covscript"
						}
					},
					"match": "(#@@)[a-zA-Z_]\\w*",
					"name": "variable.other.readwrite.class.covscript"
				},
				{
					"captures": {
						"1": {
							"name": "punctuation.definition.variable.covscript"
						}
					},
					"match": "(#\\$)[a-zA-Z_]\\w*",
					"name": "variable.other.readwrite.global.covscript"
				}
			]
		},
		"nest_brackets": {
			"begin": "\\[",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "]",
			"patterns": [
				{
					"include": "#nest_brackets"
				}
			]
		},
		"nest_brackets_i": {
			"begin": "\\[",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "]",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_brackets_i"
				}
			]
		},
		"nest_brackets_r": {
			"begin": "\\[",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "]",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_brackets_r"
				}
			]
		},
		"nest_curly": {
			"begin": "{",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "}",
			"patterns": [
				{
					"include": "#nest_curly"
				}
			]
		},
		"nest_curly_and_self": {
			"patterns": [
				{
					"begin": "{",
					"captures": {
						"0": {
							"name": "punctuation.section.scope.covscript"
						}
					},
					"end": "}",
					"patterns": [
						{
							"include": "#nest_curly_and_self"
						}
					]
				},
				{
					"include": "$self"
				}
			]
		},
		"nest_curly_i": {
			"begin": "{",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "}",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_curly_i"
				}
			]
		},
		"nest_curly_r": {
			"begin": "{",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "}",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_curly_r"
				}
			]
		},
		"nest_ltgt": {
			"begin": "<",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": ">",
			"patterns": [
				{
					"include": "#nest_ltgt"
				}
			]
		},
		"nest_ltgt_i": {
			"begin": "<",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": ">",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_ltgt_i"
				}
			]
		},
		"nest_ltgt_r": {
			"begin": "<",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": ">",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_ltgt_r"
				}
			]
		},
		"nest_parens": {
			"begin": "\\(",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "\\)",
			"patterns": [
				{
					"include": "#nest_parens"
				}
			]
		},
		"nest_parens_i": {
			"begin": "\\(",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "\\)",
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"include": "#nest_parens_i"
				}
			]
		},
		"nest_parens_r": {
			"begin": "\\(",
			"captures": {
				"0": {
					"name": "punctuation.section.scope.covscript"
				}
			},
			"end": "\\)",
			"patterns": [
				{
					"include": "#regex_sub"
				},
				{
					"include": "#nest_parens_r"
				}
			]
		},
		"regex_sub": {
			"patterns": [
				{
					"include": "#interpolated_ruby"
				},
				{
					"include": "#escaped_char"
				},
				{
					"captures": {
						"1": {
							"name": "punctuation.definition.arbitrary-repetition.covscript"
						},
						"3": {
							"name": "punctuation.definition.arbitrary-repetition.covscript"
						}
					},
					"match": "({)\\d+(,\\d+)?(})",
					"name": "string.regexp.arbitrary-repetition.covscript"
				},
				{
					"begin": "\\[(?:\\^?])?",
					"captures": {
						"0": {
							"name": "punctuation.definition.character-class.covscript"
						}
					},
					"end": "]",
					"name": "string.regexp.character-class.covscript",
					"patterns": [
						{
							"include": "#escaped_char"
						}
					]
				},
				{
					"begin": "\\(\\?#",
					"beginCaptures": {
						"0": {
							"name": "punctuation.definition.comment.begin.covscript"
						}
					},
					"end": "\\)",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.comment.end.covscript"
						}
					},
					"name": "comment.line.number-sign.covscript",
					"patterns": [
						{
							"include": "#escaped_char"
						}
					]
				},
				{
					"begin": "\\(",
					"captures": {
						"0": {
							"name": "punctuation.definition.group.covscript"
						}
					},
					"end": "\\)",
					"name": "string.regexp.group.covscript",
					"patterns": [
						{
							"include": "#regex_sub"
						}
					]
				},
				{
					"begin": "(?<=^|\\s)(#)\\s(?=[[a-zA-Z0-9,. \\t?!-][^\\x{00}-\\x{7F}]]*$)",
					"beginCaptures": {
						"1": {
							"name": "punctuation.definition.comment.covscript"
						}
					},
					"comment": "We are restrictive in what we allow to go after the comment character to avoid false positives, since the availability of comments depend on regexp flags.",
					"end": "$\\n?",
					"endCaptures": {
						"0": {
							"name": "punctuation.definition.comment.covscript"
						}
					},
					"name": "comment.line.number-sign.covscript"
				}
			]
		},
		"yard": {
			"name": "comment.line.yard.covscript",
			"patterns": [
				{
					"include": "#yard_comment"
				},
				{
					"include": "#yard_name_types"
				},
				{
					"include": "#yard_param_types"
				},
				{
					"include": "#yard_tag"
				},
				{
					"include": "#yard_types"
				},
				{
					"include": "#yard_directive"
				}
			]
		},
		"yard_comment": {
			"comment": "For YARD tags that follow the tag-comment pattern",
			"begin": "^(\\s*)(#)(\\s*)(@)(abstract|api|author|deprecated|example|macro|note|overload|since|todo|version)(?=\\s|$)",
			"beginCaptures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				}
			},
			"end": "^(?!\\s*#\\3\\s{2,})",
			"contentName": "comment.line.string.yard.covscript",
			"name": "comment.line.number-sign.covscript",
			"patterns": [
				{
					"include": "#yard"
				},
				{
					"include": "#yard_continuation"
				}
			]
		},
		"yard_name_types": {
			"comment": "For YARD tags that follow the tag-name-types-comment pattern",
			"begin": "^(\\s*)(#)(\\s*)(@)(attr|attr_reader|attr_writer|see|yieldparam)(?=\\s)(\\s+([a-z_][a-zA-Z_]*))?(\\s+((\\[).+(])))?",
			"beginCaptures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				},
				"6": {
					"name": "comment.line.yard.covscript"
				},
				"7": {
					"name": "comment.line.parameter.yard.covscript"
				},
				"8": {
					"name": "comment.line.yard.covscript"
				},
				"9": {
					"name": "comment.line.type.yard.covscript"
				},
				"10": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"11": {
					"name": "comment.line.punctuation.yard.covscript"
				}
			},
			"end": "^(?!\\s*#\\3\\s{2,})",
			"contentName": "comment.line.string.yard.covscript",
			"name": "comment.line.number-sign.covscript",
			"patterns": [
				{
					"include": "#yard"
				},
				{
					"include": "#yard_continuation"
				}
			]
		},
		"yard_param_types": {
			"comment": "For YARD tags that follow the tag-param-types-comment pattern",
			"begin": "^(\\s*)(#)(\\s*)(@)(option|param)(?=\\s)(\\s+([a-z_][a-zA-Z_]*:?))?(\\s+((\\[).+(])))?(\\s+(:[a-z_][a-zA-Z_]*))?",
			"beginCaptures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				},
				"6": {
					"name": "comment.line.yard.covscript"
				},
				"7": {
					"name": "comment.line.parameter.yard.covscript"
				},
				"8": {
					"name": "comment.line.yard.covscript"
				},
				"9": {
					"name": "comment.line.type.yard.covscript"
				},
				"10": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"11": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"12": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"13": {
					"name": "comment.line.keyword.yard.covscript"
				},
				"14": {
					"name": "comment.line.punctuation.yard.covscript"
				}
			},
			"end": "^(?!\\s*#\\3\\s{2,})",
			"contentName": "comment.line.string.yard.covscript",
			"name": "comment.line.number-sign.covscript",
			"patterns": [
				{
					"include": "#yard"
				},
				{
					"include": "#yard_continuation"
				}
			]
		},
		"yard_tag": {
			"comment": "For YARD tags that are just the tag",
			"match": "^(\\s*)(#)(\\s*)(@)(private)$",
			"captures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				}
			},
			"name": "comment.line.number-sign.covscript"
		},
		"yard_types": {
			"comment": "For YARD tags that follow the tag-types-comment pattern",
			"begin": "^(\\s*)(#)(\\s*)(@)(raise|return|yield(?:return)?)(?=\\s)(\\s+((\\[).+(])))?",
			"beginCaptures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				},
				"6": {
					"name": "comment.line.yard.covscript"
				},
				"7": {
					"name": "comment.line.type.yard.covscript"
				},
				"8": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"9": {
					"name": "comment.line.punctuation.yard.covscript"
				}
			},
			"end": "^(?!\\s*#\\3\\s{2,})",
			"contentName": "comment.line.string.yard.covscript",
			"name": "comment.line.number-sign.covscript",
			"patterns": [
				{
					"include": "#yard"
				},
				{
					"include": "#yard_continuation"
				}
			]
		},
		"yard_directive": {
			"comment": "For YARD directives",
			"begin": "^(\\s*)(#)(\\s*)(@!)(attribute|endgroup|group|macro|method|parse|scope|visibility)(\\s+((\\[).+(])))?(?=\\s)",
			"beginCaptures": {
				"1": {
					"name": "comment.line.yard.covscript"
				},
				"2": {
					"name": "punctuation.definition.comment.covscript"
				},
				"3": {
					"name": "comment.line.yard.covscript"
				},
				"4": {
					"name": "comment.line.keyword.punctuation.yard.covscript"
				},
				"5": {
					"name": "comment.line.keyword.yard.covscript"
				},
				"6": {
					"name": "comment.line.yard.covscript"
				},
				"7": {
					"name": "comment.line.type.yard.covscript"
				},
				"8": {
					"name": "comment.line.punctuation.yard.covscript"
				},
				"9": {
					"name": "comment.line.punctuation.yard.covscript"
				}
			},
			"end": "^(?!\\s*#\\3\\s{2,})",
			"contentName": "comment.line.string.yard.covscript",
			"name": "comment.line.number-sign.covscript",
			"patterns": [
				{
					"include": "#yard"
				},
				{
					"include": "#yard_continuation"
				}
			]
		},
		"yard_continuation": {
			"match": "^\\s*#",
			"name": "punctuation.definition.comment.covscript"
		}
	}
}
